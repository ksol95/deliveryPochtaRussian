(()=>{"use strict";var n="https://delivery.pochta.ru/",e="v2/calculate/tariff/delivery",t=function(n){return n.ok?n.json():Promise.reject(n.status)},c=function(c){var o=new URLSearchParams(c);return fetch("".concat(n).concat(e,"?")+o.toString(),{method:"GET"}).then(t)},o=document.querySelector(".response"),l=document.querySelector(".deilvery-info"),i=l.toIndex,r=l.weight,a=l.sumoc,s={json:"",object:"4040",service:"22",increment:50,to:"681000",from:"445042",weight:"2000",size:"85x18x9",sumoc:"490000"};function u(n){return n.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1.")}var m=function(){s.weight=r.value,s.sumoc=100*a.value,s.to=i.value,c(s).then((function(n){console.log(n);var e={json:"",object:s.object,service:s.service,to:s.to,from:s.from,weight:s.weight,size:s.size,sumoc:n.sumoc+n.paynds};c(e).then((function(n){console.log(n),o.innerHTML="Загрузка...";var e=100*Math.round(n.paynds/100/100)+s.increment,t=n.delivery.min,c=n.delivery.max,l=s.sumoc/100+e,i=document.createElement("div");i.classList.add("delivery-result"),i.innerHTML="\n            <p>Детали расчёта (не для клиента)</p>\n            <ul>\n              <li><small>Тариф: ".concat(Math.round(n.ground.valnds/100)," руб.</small></li>\n              <li><small>Плата за объявленную ценность: ").concat(n.cover.valnds/100," руб.</small></li>\n              <li><small>Дополнительные услуги: ").concat(n.service.valnds/100," руб.</small></li>\n              <li><small>Допы: ").concat(s.increment," руб.</small></li>\n            </ul>\n            <p>Расчёт для клиента:</p>\n            <ul>\n              <li>Стоимость доставки: ").concat(u(e)," руб.;</li>\n              <li>Срок доставки: от ").concat(++t," до ").concat(++c," дней;</li>\n              <li>Итого: ").concat(u(l)," руб.;</li>\n              <li>(+ комиссия за денежный перевод через почту России: ").concat(u(Math.round(function(n){return n<=1e4?41.67+n/100*4.17:166.67+n/100*3.33}(l)))," руб.)</li>\n            </ul>\n          "),o.innerHTML="",o.append(i)}))})).catch((function(n){console.error(n),o.innerHTML="",o.innerHTML="Ошибка: ".concat(n)}))};l.addEventListener("submit",(function(n){n.preventDefault(),m()})),r.value=s.weight,a.value=s.sumoc/100,i.value=s.to,m()})();